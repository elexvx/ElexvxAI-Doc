---
import { getCollection } from 'astro:content';
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import Footer from '../components/Footer.astro';

const blogEntries = await getCollection('blog');
const posts = blogEntries.map(entry => ({
  slug: entry.slug,
  ...entry.data
}));
---

<Layout title="Blog | ElexvxAI Lab">
  <Navbar />
  <main class="blog-main section">
    <div class="container">
      
      <!-- Hero Section -->
      <section class="blog-hero">
        <div class="hero-content">
          <span class="badge hero-badge">Featured Research</span>
          <h1 class="display-medium mt-4 text-white">Latest Research & Insights</h1>
          <p class="body-large text-gray-300 mt-4 mb-8 hero-subtext">Exploring the frontiers of Artificial Intelligence, Machine Learning, and Computer Vision through our latest lab publications.</p>
          <a href="#" class="btn btn-filled hero-btn">Read Featured Article &rarr;</a>
        </div>
      </section>

      <!-- Filter Section -->
      <section class="blog-filters">
        <div class="filter-pills">
          <button class="pill active">All Posts</button>
          <button class="pill">Engineering</button>
          <button class="pill">Research</button>
          <button class="pill">Case Studies</button>
          <button class="pill">Tutorials</button>
        </div>
        <div class="sort-dropdown">
          <span>Sort by: Newest</span>
          <svg class="chevron" xmlns="http://www.w3.org/2000/svg" height="20" viewBox="0 0 24 24" width="20" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"></polyline></svg>
        </div>
      </section>

      <!-- Blog Grid Section -->
      <section class="blog-grid">
        {posts.map(post => (
          <a href={`/blog/${post.slug}`} class="blog-card card-elevated" style="text-decoration: none; color: inherit;">
            <div class="card-image-wrapper">
              <img src={post.image} alt={post.title} class="card-image" />
              <div class="card-category-badge">{post.category}</div>
            </div>
            <div class="card-content">
              <div class="card-meta">
                {post.date} &bull; {post.readTime}
              </div>
              <h2 class="title-large mt-2 mb-2 card-title">{post.title}</h2>
              <p class="body-large card-excerpt mb-4">{post.excerpt}</p>
              
              <div class="card-author">
                <div class="author-info">
                  <div class="author-avatar">{post.author.charAt(0)}</div>
                  <span class="author-name">{post.author}</span>
                </div>
                <div class="action-icon">&rarr;</div>
              </div>
            </div>
          </a>
        ))}
      </section>

      <!-- Load More -->
      <div class="load-more-container">
        <button class="btn btn-outlined load-more-btn">Load More Articles</button>
      </div>

    </div>
  </main>
  <Footer />
</Layout>

<style>
/* Utilities */
.mt-2 { margin-top: 8px; }
.mt-4 { margin-top: 16px; }
.mb-2 { margin-bottom: 8px; }
.mb-4 { margin-bottom: 16px; }
.mb-8 { margin-bottom: 32px; }

/* Hero Section */
.blog-hero {
  background-color: #0f172a; /* Dark navy */
  background-image: radial-gradient(circle at 80% 20%, rgba(37, 99, 235, 0.15), transparent 40%),
                    radial-gradient(circle at 10% 80%, rgba(0, 188, 212, 0.1), transparent 30%);
  border-radius: var(--md-sys-shape-corner-extra-large);
  padding: 80px 48px;
  position: relative;
  overflow: hidden;
  margin-bottom: 48px;
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
}

.hero-content {
  position: relative;
  z-index: 2;
  max-width: 600px;
}

.text-white {
  color: #ffffff !important;
}

.text-gray-300 {
  color: #d1d5db !important;
}

.hero-badge {
  background-color: rgba(37, 99, 235, 0.2);
  color: #60a5fa;
  border: 1px solid rgba(59, 130, 246, 0.3);
}

.hero-btn {
  border-radius: var(--md-sys-shape-corner-full);
}

/* Filters */
.blog-filters {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 48px;
  flex-wrap: wrap;
  gap: 16px;
}

.filter-pills {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.pill {
  padding: 8px 20px;
  border-radius: var(--md-sys-shape-corner-full);
  border: none;
  background-color: var(--md-sys-color-surface-container-high);
  color: var(--md-sys-color-on-surface);
  font-size: var(--md-sys-typescale-label-large-font-size);
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
}

.pill:hover {
  background-color: var(--md-sys-color-surface-container-highest);
}

.pill.active {
  background-color: #111827; /* Dark gray for light theme active */
  color: #ffffff;
}

:root.dark .pill.active {
  background-color: #f3f4f6; /* Light gray for dark theme active */
  color: #111827;
}

.sort-dropdown {
  display: flex;
  align-items: center;
  gap: 8px;
  color: var(--md-sys-color-on-surface-variant);
  font-size: var(--md-sys-typescale-label-large-font-size);
  font-weight: 500;
  cursor: pointer;
}

/* Blog Grid */
.blog-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
  gap: 32px;
  margin-bottom: 64px;
}

.blog-card {
  padding: 0; /* Override generic card padding */
  display: flex;
  flex-direction: column;
  overflow: hidden;
  height: 100%;
}

.card-image-wrapper {
  position: relative;
  height: 200px;
  overflow: hidden;
  border-radius: var(--md-sys-shape-corner-extra-large) var(--md-sys-shape-corner-extra-large) 0 0;
}

.card-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
}

.blog-card:hover .card-image {
  transform: scale(1.05);
}

.card-category-badge {
  position: absolute;
  top: 16px;
  left: 16px;
  background-color: rgba(255, 255, 255, 0.9);
  color: #111827;
  padding: 4px 12px;
  border-radius: var(--md-sys-shape-corner-small);
  font-size: 10px;
  font-weight: 700;
  letter-spacing: 1px;
}

:root.dark .card-category-badge {
  background-color: rgba(0, 0, 0, 0.8);
  color: #f3f4f6;
}

.card-content {
  padding: 24px;
  display: flex;
  flex-direction: column;
  flex-grow: 1;
}

.card-meta {
  font-size: var(--md-sys-typescale-label-medium-font-size);
  color: var(--md-sys-color-on-surface-variant);
  margin-bottom: 8px;
}

.card-title {
  color: var(--md-sys-color-on-surface);
  line-height: 1.3;
}

.card-excerpt {
  flex-grow: 1;
  font-size: 15px;
  line-height: 1.6;
}

.card-author {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid var(--md-sys-color-surface-container-high);
}

.author-info {
  display: flex;
  align-items: center;
  gap: 12px;
}

.author-avatar {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background-color: var(--md-sys-color-primary-container);
  color: var(--md-sys-color-on-primary-container);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: 600;
  font-size: 14px;
}

.author-name {
  font-weight: 500;
  font-size: 14px;
  color: var(--md-sys-color-on-surface);
}

.action-icon {
  color: var(--md-sys-color-primary);
  font-weight: bold;
}

/* Load More */
.load-more-container {
  display: flex;
  justify-content: center;
}

.load-more-btn {
  border-radius: var(--md-sys-shape-corner-full);
}

/* Responsive */
@media (max-width: 768px) {
  .blog-hero {
    padding: 48px 24px;
  }
}
</style>
